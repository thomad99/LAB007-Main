<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VIN Value - LAB007</title>
    <link rel="icon" type="image/png" href="/images/lab007 Icon.PNG">
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body { 
        font-family: system-ui, Arial, sans-serif; 
        margin: 0; 
        padding: 0;
        color: #e2e8f0; 
        min-height: 100vh;
        background: linear-gradient(120deg, #334155, #374151, #475569);
        background-size: 400% 400%;
        background-attachment: fixed;
        animation: gradientShift 45s ease infinite;
        display: flex;
        flex-direction: column;
      }
      body.working {
        background: linear-gradient(120deg, #3b82f6, #8b5cf6, #ef4444, #10b981);
        background-size: 400% 400%;
        background-attachment: fixed;
        animation: gradientShiftActive 2s ease-in-out infinite;
        filter: saturate(1.3) brightness(1.1);
      }
      @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      @keyframes gradientShiftActive {
        0% { background-position: 0% 50%; }
        25% { background-position: 100% 0%; }
        50% { background-position: 100% 100%; }
        75% { background-position: 0% 100%; }
        100% { background-position: 0% 50%; }
      }
      /* Respect reduced motion */
      @media (prefers-reduced-motion: reduce) {
        body { animation: none; }
      }

      /* Top Bar - Logo and Hamburger */
      .top-bar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1001;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }

      .top-bar-content {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        width: 100%;
        max-width: 1200px;
        position: relative;
      }

      .top-logo {
        max-width: 238px;
        height: auto;
        display: block;
      }

      /* Hamburger Menu */
      .menu-toggle {
        position: relative;
        z-index: 1002;
        background: white;
        color: #0066cc;
        border: 1px solid #0066cc;
        width: 72px;
        height: 72px;
        border-radius: 5px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 7px;
        transition: all 0.3s ease;
      }

      .menu-toggle:hover {
        background: #f0f0f0;
      }

      .menu-toggle span {
        display: block;
        width: 36px;
        height: 5px;
        background: #0066cc;
        border-radius: 2px;
        transition: all 0.3s ease;
      }

      .menu-toggle.active span:nth-child(1) {
        transform: rotate(45deg) translate(8px, 8px);
      }

      .menu-toggle.active span:nth-child(2) {
        opacity: 0;
      }

      .menu-toggle.active span:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -7px);
      }

      /* Menu Overlay */
      .menu-overlay {
        position: fixed;
        top: 0;
        right: 0;
        width: 50%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        z-index: 1000;
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 20px;
        overflow-y: auto;
        box-shadow: -4px 0 20px rgba(0, 0, 0, 0.3);
      }

      .menu-overlay.active {
        display: flex;
      }

      .menu-items {
        list-style: none;
        text-align: center;
        width: 100%;
        max-width: 400px;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100%;
      }

      .menu-items li {
        margin: 8px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 8px;
        width: 100%;
      }

      .menu-items li:last-child {
        border-bottom: none;
      }

      .menu-items a {
        color: white;
        text-decoration: none;
        font-size: 1.1em;
        font-weight: 600;
        transition: all 0.3s ease;
        display: block;
        padding: 8px 15px;
        border-radius: 5px;
      }

      .menu-items a:hover {
        color: #d4af37;
        background: rgba(212, 175, 55, 0.1);
        padding-left: 20px;
      }

      .container { 
        max-width: 680px; 
        margin: 100px auto 20px;
        padding: 24px;
        flex: 1;
      }
      h1 { margin: 0 0 16px; font-size: 28px; }
      form { display: grid; gap: 12px; background: #111827; padding: 16px; border-radius: 8px; border: 1px solid #1f2937; }
      label { display: block; font-size: 14px; color: #cbd5e1; margin-bottom: 4px; }
      input { width: 100%; padding: 10px 12px; border-radius: 6px; border: 1px solid #374151; background: #0b1020; color: #e5e7eb; box-sizing: border-box; }
      button { padding: 10px 14px; border-radius: 6px; border: 1px solid #334155; background: #2563eb; color: white; cursor: pointer; font-weight: 600; }
      button:disabled { opacity: 0.6; cursor: not-allowed; }
      .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items: start; }
      .vin-row { display: grid; grid-template-columns: 1fr auto; gap: 12px; align-items: end; }
      .result { margin-top: 16px; padding: 12px; border-radius: 8px; border: 1px solid #1f2937; background: #0b1020; }
      .muted { color: #94a3b8; font-size: 13px; }
      #progress { 
        background: #1f2937; 
        padding: 16px; 
        border-radius: 8px; 
        margin: 12px 0; 
        border-left: 4px solid #3b82f6;
        font-weight: 600;
        font-size: 16px;
        min-height: 24px;
        color: #e5e7eb;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        animation: pulse 2s infinite;
      }
      
      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.8; }
      }
      a { color: #93c5fd; }
      .logo { display: none; }

      @media (max-width: 768px) {
        .top-bar {
          padding: 8px 15px;
        }

        .top-logo {
          max-width: 150px;
        }

        .menu-toggle {
          width: 60px;
          height: 60px;
        }

        .menu-toggle span {
          width: 30px;
          height: 4px;
        }

        .menu-overlay {
          width: 100%;
        }

        .menu-items {
          max-width: 90%;
        }

        .menu-items li {
          margin: 4px 0;
          padding-bottom: 4px;
        }

        .menu-items a {
          font-size: 0.9em;
          padding: 6px 10px;
        }

        .container {
          margin-top: 80px;
          padding: 16px;
        }

        .row {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <!-- Top Bar with Logo and Hamburger -->
    <div class="top-bar">
      <div class="top-bar-content">
        <img src="/images/lab007-trans.PNG" alt="LAB007 Logo" class="top-logo">
        <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>

    <!-- Menu Overlay -->
    <div class="menu-overlay" id="menuOverlay">
      <ul class="menu-items">
        <li><a href="/">HOME</a></li>
        <li><a href="/citrix">Citrix-2-HZ</a></li>
        <li><a href="/3dprint">3D Print</a></li>
        <li><a href="/webalert">Web-Alerts</a></li>
        <li><a href="/vinvalue">VinValue</a></li>
        <li><a href="https://lovesailing.ai" target="_blank">LoveSailing</a></li>
        <li><a href="https://lovesailing-chatbot.onrender.com/chat" target="_blank">SailBOT</a></li>
        <li><a href="https://lab007-sail-scanner2.onrender.com/sail-live-scan.html" target="_blank">SailScan</a></li>
        <li><a href="/contact">Contact</a></li>
      </ul>
    </div>

    <div class="container">
      <form id="valueForm">
        <div>
          <label for="vin">VIN</label>
          <div class="vin-row">
            <input id="vin" name="vin" placeholder="Enter VIN" required />
            <button id="scanVin" type="button" title="Scan image using camera">Scan Image</button>
          </div>
          <input id="vinImage" type="file" accept="image/*" capture="environment" style="display:none" />
        </div>
        <div class="row">
          <div>
            <label for="mileage">Mileage</label>
            <input id="mileage" name="mileage" type="number" placeholder="e.g. 45000" required />
          </div>
          <div>
            <label for="zip">Zip Code</label>
            <input id="zip" name="zip" placeholder="Loading default..." />
          </div>
        </div>
        <div>
          <label for="email">Email</label>
          <input id="email" name="email" type="email" placeholder="Loading default..." />
        </div>
        <button id="submit" type="submit">Get Valuation</button>
      </form>
      <div id="scanResult" style="display:none; margin-top: 20px; padding: 16px; background: #1f2937; border-radius: 8px; border: 1px solid #374151; color: #cbd5e1;">
        <div id="scanResultContent"></div>
      </div>
      <div id="result" class="result" hidden>
        
          <div id="webuyValue" style="text-align: center; padding: 20px; background: #1f2937; border-radius: 8px; border: 1px solid #374151;">
            <h3 style="margin: 0 0 8px; color: #3b82f6; font-size: 18px;">WeBuyAnyCar Valuation</h3>
            <div id="webuyPrice" style="font-size: 36px; font-weight: 800; color: #10b981;"></div>
          </div>
        </div>
        <div id="details" style="margin-top: 12px;">
          <button id="toggleDetails" type="button" style="background: #374151; border: 1px solid #4b5563; color: #d1d5db; padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;">Show Details</button>
          <div id="detailsContent" style="display: none; margin-top: 8px;">
            <div id="progress" class="muted" style="white-space: pre-line;"></div>
            <div id="progressBar" style="width: 100%; height: 4px; background: #374151; border-radius: 2px; margin-top: 8px; overflow: hidden;">
              <div id="progressFill" style="width: 0%; height: 100%; background: linear-gradient(90deg, #3b82f6, #8b5cf6); border-radius: 2px; transition: width 0.3s ease;"></div>
            </div>
            <div id="shots" style="margin-top:8px"></div>
          </div>
        </div>
        <div id="error" style="color: #fca5a5"></div>
      </div>
    </div>

    <script>
      const form = document.getElementById('valueForm');
      const result = document.getElementById('result');
      const webuyPrice = document.getElementById('webuyPrice');
      const error = document.getElementById('error');
      const progress = document.getElementById('progress');
      const progressFill = document.getElementById('progressFill');
      const shots = document.getElementById('shots');
      const submit = document.getElementById('submit');
      const scanVinBtn = document.getElementById('scanVin');
      const vinInput = document.getElementById('vin');
      const vinImage = document.getElementById('vinImage');
      const zipInput = document.getElementById('zip');
      const emailInput = document.getElementById('email');
      const toggleDetails = document.getElementById('toggleDetails');
      const detailsContent = document.getElementById('detailsContent');

      // Hamburger menu functionality
      const menuToggle = document.getElementById('menuToggle');
      const menuOverlay = document.getElementById('menuOverlay');

      // Create backdrop for clicking outside
      const backdrop = document.createElement('div');
      backdrop.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999; display: none !important; visibility: hidden;';
      backdrop.id = 'menuBackdrop';
      document.body.appendChild(backdrop);

      menuToggle.addEventListener('click', function() {
        const isActive = menuToggle.classList.toggle('active');
        menuOverlay.classList.toggle('active');
        if (isActive) {
          backdrop.style.display = 'block';
          backdrop.style.visibility = 'visible';
        } else {
          backdrop.style.display = 'none';
          backdrop.style.visibility = 'hidden';
        }
      });

      backdrop.addEventListener('click', function() {
        menuToggle.classList.remove('active');
        menuOverlay.classList.remove('active');
        backdrop.style.display = 'none';
        backdrop.style.visibility = 'hidden';
      });

      // Close menu when clicking a link
      const menuLinks = document.querySelectorAll('.menu-items a');
      menuLinks.forEach(link => {
        link.addEventListener('click', function() {
          menuToggle.classList.remove('active');
          menuOverlay.classList.remove('active');
          backdrop.style.display = 'none';
          backdrop.style.visibility = 'hidden';
        });
      });

      // Add click handler to submit button for debugging
      submit.addEventListener('click', (e) => {
        console.log('Submit button clicked!');
      });

      form.addEventListener('submit', async (e) => {
        